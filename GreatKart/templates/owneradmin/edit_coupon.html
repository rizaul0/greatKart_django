{% extends 'owneradmin/base_owner.html' %}
{% load static %}

{% block owner_content %}

<div class="d-flex justify-content-between align-items-center mb-4">
    <h4>Edit Coupon</h4>
    <a href="{% url 'owner_coupons' %}" class="btn btn-light">
        ‚Üê Back to Coupons
    </a>
</div>

<div class="card">
    <div class="card-body">

        <form method="POST">
            {% csrf_token %}

            <!-- Coupon Code -->
            <div class="form-group mb-3">
                <label>Coupon Code</label>
                <input type="text"
                       name="code"
                       class="form-control"
                       value="{{ coupon.code }}"
                       required>
            </div>

            <!-- Discount Percent -->
            <div class="form-group mb-3">
                <label>Discount Percentage (%)</label>
                <input type="number"
                       name="discount_percent"
                       class="form-control"
                       min="1"
                       max="100"
                       value="{{ coupon.discount_percent }}"
                       required>
            </div>

            <!-- Max Discount -->
            <div class="form-group mb-3">
                <label>Max Discount Amount (optional)</label>
                <input type="number"
                       step="0.01"
                       name="max_discount_amount"
                       class="form-control"
                       value="{{ coupon.max_discount_amount }}">
            </div>

            <!-- Valid From -->
            <div class="form-group mb-3">
                <label>Valid From</label>
                <input type="datetime-local"
                       name="valid_from"
                       class="form-control"
                       value="{{ coupon.valid_from|date:'Y-m-d\\TH:i' }}"
                       required>
            </div>

            <!-- Valid To -->
            <div class="form-group mb-3">
                <label>Valid To</label>
                <input type="datetime-local"
                       name="valid_to"
                       class="form-control"
                       value="{{ coupon.valid_to|date:'Y-m-d\\TH:i' }}"
                       required>
            </div>

            <!-- Usage Limit -->
            <div class="form-group mb-3">
                <label>Usage Limit</label>
                <input type="number"
                       name="usage_limit"
                       class="form-control"
                       min="1"
                       value="{{ coupon.usage_limit }}"
                       required>
            </div>

            <!-- Products -->
            <div class="form-group mb-4">
                <label>Applicable Products</label>
                <small class="text-muted d-block mb-2">
                    Leave empty to apply on all products
                </small>

                <select name="products"
                        multiple
                        class="form-control"
                        size="8">

                    {% for product in products %}
                        <option value="{{ product.id }}"
                            {% if product in coupon.products.all %}
                                selected
                            {% endif %}>
                            {{ product.product_name }}
                        </option>
                    {% endfor %}

                </select>
            </div>

            <!-- Active -->
            <div class="form-check mb-4">
                <input class="form-check-input"
                       type="checkbox"
                       name="is_active"
                       id="is_active"
                       {% if coupon.is_active %}checked{% endif %}>
                <label class="form-check-label" for="is_active">
                    Coupon is active
                </label>
            </div>

            <!-- Actions -->
            <div class="d-flex justify-content-end gap-2">
                <a href="{% url 'owner_coupons' %}"
                   class="btn btn-light">
                    Cancel
                </a>
                <button type="submit"
                        class="btn btn-primary">
                    Update Coupon
                </button>
            </div>

        </form>

    </div>
</div>

{% endblock %}
