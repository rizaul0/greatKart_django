{% extends 'base_template.html' %}
{% load static %}

{% block content %}

<!-- ========================= SECTION CONTENT ========================= -->
<section class="section-conten padding-y bg">
{% for message in messages %}
  <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
	{{ message }}
	<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
  </div>
{% endfor %}
<div class="container">
	<div class="row">

		<!-- SIDEBAR -->
		<aside class="col-md-3">
    <ul class="list-group">
        <a class="list-group-item active" href="{% url 'dashboard' %}">
            My Orders
        </a>
        <a class="list-group-item" href="{% url 'edit_address' %}">
            Update Address
        </a>
    </ul>

    <br>

    <a class="btn btn-light btn-block" href="{% url 'logout' %}">
        <i class="fa fa-power-off"></i>
        <span class="text">Log out</span>
    </a>
</aside>

		<!-- SIDEBAR END -->

		<!-- MAIN CONTENT -->
		<main class="col-md-9">
			<article class="card">

				{% for order in orders %}
<article class="card mb-4">

    <header class="card-header">
        <strong class="d-inline-block mr-3">
            Order ID: {{ order.order_number }}
        </strong>
        <span>Order Date: {{ order.created_at|date:"d M Y" }}</span>
    </header>

    <div class="card-body">
        <div class="row">

            <div class="col-md-8">
                <h6 class="text-muted">Delivery to</h6>
                <p>
                    {{ order.user.first_name }} {{ order.user.last_name }} <br>
                    Phone: {{ order.user.phone }} <br>
                    Email: {{ order.user.email }} <br>
                    Location:
                    {{ order.user.house }},
                    {{ order.user.street }},
                    {{ order.user.city }},
                    {{ order.user.state }},
                    {{ order.user.zip }} <br>
                    Country: {{ order.user.country }}
                </p>
            </div>

            <div class="col-md-4">
                <h6 class="text-muted">Payment</h6>
                <span class="text-success">
                    <i class="fab fa-lg fa-cc-visa"></i>
                    {{ order.payment_method|default:"COD" }}
                </span>

                <p class="mt-2">
                    Subtotal: Rs. {{ order.order_total|floatformat:2 }} <br>
                    Tax: Rs. {{ order.tax|floatformat:2 }} <br>
                    <strong>Total: Rs. {{ order.order_total|floatformat:2 }}</strong>
                </p>
            </div>

        </div>
    </div>

    <div class="table-responsive">
        <table class="table table-hover">

            {% for item in order.orderproduct_set.all %}
            <tr>
                <td width="65">
                    <img src="{{ item.product.image.url }}" class="img-xs border">
                </td>
                <td>
                    <p class="title mb-0">{{ item.product.product_name }}</p>
                    <small class="text-muted">
                        Variant: {{ item.variant.variant_value|default:"-" }}
                    </small>
                </td>
                <td>
                    {{ item.product.brand }} <br>
                    Qty: {{ item.quantity }}
                </td>
                <td width="250">
                   
                </td>
            </tr>
            {% endfor %}

        </table>
    </div>

</article>
{% empty %}
<div class="alert alert-info">
    You have not placed any orders yet.
</div>
{% endfor %}



				

			</article>
		</main>
		<!-- MAIN CONTENT END -->

	</div>
</div>

</section>
<!-- ========================= SECTION CONTENT END ========================= -->

{% endblock %}
